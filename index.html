<script>
    const PROXY_URL = "https://rough-bush-1bda.talll77.workers.dev";

    const APP_DATA = {
        employees: [
            { he: "רשיד באקייב", ru: "Рашид Бакаев", id: "10211" },
            { he: "טל לדיז'ינסקי", ru: "Таль Ладыжинский", id: "10201" },
            { he: "סרגיי סופוניצקי", ru: "Сергей Софоницкий", id: "100149" },
            { he: "אנדריי בייטין", ru: "Андрей Бейтин", id: "101088" },
            { he: "קרימר אלכסנדר", ru: "Александр Кример", id: "10238" },
            { he: "קוסטיה אסקרוב", ru: "Костя Aскаров", id: "10318" },
            { he: "אנג'ליקה פומזונובסקי", ru: "Анжелика Помозоновски", id: "10229" }
        ],
        main_course: [
            { he: "מגש", ru: "В лотке (Хамгашит)" },
            { he: "בפיתה (כולל פחית שתייה)", ru: "В пите (включая напиток)" },
            { he: "בבגט (כולל פחית שתייה)", ru: "В багете (включая напиток)" }
        ],
        meat: [
            { he: "מעורב גבי", ru: "смешанный Габи" },
            { he: "פרגית", ru: "Паргит" },
            { he: "שווארמה", ru: "Шаурма" },
            { he: "קבב", ru: "Кебаб" }
        ],
        beverages: [
            { he: "קולה זירו", ru: "Кола Зеро" },
            { he: "קולה", ru: "Кола" },
            { he: "ספרייט", ru: "Спрайт" }
        ],
        common_notes: ["בלי בצל", "לא קולה. או ספרייט", "לא לשים בצל חי", "לי בלי לי - בצל חיי"]
    };

    const UI = {
        lang: 'he',
        
        init() {
            this.renderMenus();
            this.updatePlaceholders();
        },

        renderMenus() {
            // רינדור רשימת עובדים ל-Datalist
            const list = document.getElementById('employee-options');
            list.innerHTML = APP_DATA.employees.map(e => `<option value="${e.he}">${e.id}</option>`).join('');

            // רינדור תפריטים
            this.fillSelect('type', APP_DATA.main_course);
            this.fillSelect('meat', APP_DATA.meat);
            this.fillSelect('drink', APP_DATA.beverages);
        },

        fillSelect(id, data) {
            const el = document.getElementById(id);
            el.innerHTML = data.map(item => `<option value="${item.he}">${this.lang === 'he' ? item.he : item.ru}</option>`).join('');
        },

        updatePlaceholders() {
            const noteInput = document.getElementById('note');
            const randomNote = APP_DATA.common_notes[Math.floor(Math.random() * APP_DATA.common_notes.length)];
            noteInput.placeholder = this.lang === 'he' ? `למשל: ${randomNote}` : `Например: ${randomNote}`;
        },

        toggleLang() {
            this.lang = this.lang === 'he' ? 'ru' : 'he';
            document.documentElement.dir = this.lang === 'he' ? 'rtl' : 'ltr';
            this.renderMenus(); // עדכון שמות המנות בתפריט
            // ... שאר לוגיקת החלפת השפה מהגרסה הקודמת ...
        },

        async apiCall(action, data = {}) {
            this.setLoading(true);
            try {
                const res = await fetch(PROXY_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ action: action, ...data })
                });
                const json = await res.json();
                this.setLoading(false);
                return json.success ? json.data : (alert(json.error), null);
            } catch (e) {
                this.setLoading(false);
                alert("Connection Error");
                return null;
            }
        },

        setLoading(s) { document.getElementById('loader').style.display = s ? 'flex' : 'none'; },

        async submitOrder() {
            const name = document.getElementById('name').value;
            if(!name) return alert("בחר שם");

            const result = await this.apiCall('submitOrder', {
                data: {
                    name: name,
                    type: document.getElementById('type').value,
                    meat: document.getElementById('meat').value,
                    drink: document.getElementById('drink').value,
                    note: document.getElementById('note').value
                }
            });
            if(result) alert(result);
        }
    };

    // הפעלה ראשונית
    window.onload = () => UI.init();
</script>

<div class="field-group">
    <label id="lbl-name">שם עובד</label>
    <input type="text" id="name" list="employee-options" placeholder="חפש שם...">
    <datalist id="employee-options"></datalist>
</div>
